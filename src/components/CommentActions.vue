<template>
  <el-dialog
      title="确认删除"
      v-model="dialogVisible"
      width="30%"
      class="custom-dialog-center"
      append-to-body
  >
    <span>确定要删除这条评论吗？</span>
    <template #footer>
    <span class="dialog-footer">
      <el-button @click="dialogVisible = false">取消</el-button>
      <el-button type="primary" @click="confirmDelete">确定</el-button>
    </span>
    </template>
  </el-dialog>
  <div class="comment-actions">
    <div class="top-actions">
      <el-button class="like-btn" type="text" @click="handleLike">
        <template v-if="isLiked">
          <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20"
               height="20">
            <path
                d="M64 483.04V872c0 37.216 30.144 67.36 67.36 67.36H192V416.32l-60.64-0.64A67.36 67.36 0 0 0 64 483.04zM857.28 344.992l-267.808 1.696c12.576-44.256 18.944-83.584 18.944-118.208 0-78.56-68.832-155.488-137.568-145.504-60.608 8.8-67.264 61.184-67.264 126.816v59.264c0 76.064-63.84 140.864-137.856 148L256 416.96v522.4h527.552a102.72 102.72 0 0 0 100.928-83.584l73.728-388.96a102.72 102.72 0 0 0-100.928-121.824z"
                p-id="6726" fill="#bfbfbf"/>
          </svg>
        </template>
        <template v-else>
          <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20"
               height="20">
            <path
                d="M190.193225 471.411583c14.446014 0 26.139334-11.718903 26.139334-26.13831 0-14.44499-11.69332-26.164916-26.139334-26.164916-0.271176 0-0.490164 0.149403-0.73678 0.149403l-62.496379 0.146333c-1.425466-0.195451-2.90005-0.295735-4.373611-0.295735-19.677155 0-35.621289 16.141632-35.621289 36.114522L86.622358 888.550075c0 19.949354 15.96767 35.597753 35.670407 35.597753 1.916653 0 3.808746 0.292666 5.649674 0l61.022819 0.022513c0.099261 0 0.148379 0.048095 0.24764 0.048095 0.097214 0 0.146333-0.048095 0.24457-0.048095l0.73678 0 0-0.148379c13.413498-0.540306 24.174586-11.422144 24.174586-24.960485 0-13.55983-10.760065-24.441669-24.174586-24.981974l0-0.393973-50.949392 0 1.450025-402.275993L190.193225 471.409536z"
                fill="#bfbfbf"/>
            <path
                d="M926.52241 433.948343c-19.283182-31.445176-47.339168-44.172035-81.289398-45.546336-1.77032-0.246617-3.536546-0.39295-5.380544-0.39295l-205.447139-0.688685c13.462616-39.059598 22.698978-85.58933 22.698978-129.317251 0-28.349675-3.193739-55.962569-9.041934-82.542948l-0.490164 0.049119c-10.638291-46.578852-51.736315-81.31498-100.966553-81.31498-57.264215 0-95.466282 48.15065-95.466282 106.126063 0 3.241834-0.294712 6.387477 0 9.532097-2.996241 108.386546-91.240027 195.548698-196.23636 207.513194l0 54.881958-0.785899 222.227314 0 229.744521 10.709923 0 500.025271 0.222057 8.746198-0.243547c19.35686 0.049119 30.239721-4.817726 47.803749-16.116049 16.682961-10.761088 29.236881-25.50079 37.490869-42.156122 2.260483-3.341095 4.028757-7.075139 5.106298-11.20111l77.018118-344.324116c1.056052-4.053316 1.348718-8.181333 1.056052-12.160971C943.643346 476.446249 938.781618 453.944769 926.52241 433.948343zM893.82573 486.837924l-82.983993 367.783411-0.099261-0.049119c-2.555196 6.141884-6.879688 11.596106-12.872169 15.427364-4.177136 2.727111-8.773827 4.351098-13.414521 4.964058-1.49812-0.195451-3.046383 0-4.620227 0l-477.028511-0.540306-0.171915-407.408897c89.323375-40.266076 154.841577-79.670527 188.596356-173.661202 0.072655 0.024559 0.124843 0.049119 0.195451 0.072655 2.99931-9.137101 6.313799-20.73423 8.697079-33.164331 5.551436-29.185716 5.258771-58.123792 5.258771-58.123792-4.937452-37.98001 25.940812-52.965306 44.364417-52.965306 25.304316 0.860601 50.263777 33.656541 50.263777 52.326762 0 0 5.600555 27.563776 5.649674 57.190537 0.048095 37.366026-4.6673 56.847729-4.6673 56.847729l-0.466628 0c-5.872754 30.879288-16.214287 60.138682-30.464849 86.964654l0.36839 0.342808c-2.358721 4.815679-3.709485 10.220782-3.709485 15.943111 0 19.922748 19.088754 21.742187 38.765909 21.742187l238.761895 0.270153c0 0 14.666024 0.465604 14.690584 0.465604l0 0.100284c12.132318-0.638543 24.221658 5.207605 31.100322 16.409738 5.504364 9.016351 6.437619 19.6045 3.486404 28.988218L893.82573 486.837924z"
                fill="#bfbfbf"/>
          </svg>
        </template>
        <span style="margin-left: 7px">{{ likeCount }}</span>
      </el-button>
      <el-button class="reply-btn" @click="handleReply">
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20"
             height="20">
          <path
              d="M298.666667 128C183.893333 128 85.333333 215.125333 85.333333 329.130667v237.738666C85.333333 680.874667 183.893333 768 298.666667 768a42.666667 42.666667 0 1 0 0-85.333333c-73.728 0-128-54.784-128-115.797334V329.130667C170.666667 268.117333 224.938667 213.333333 298.666667 213.333333h426.666666c73.728 0 128 54.784 128 115.797334v237.738666C853.333333 627.882667 799.061333 682.666667 725.333333 682.666667a42.666667 42.666667 0 0 0-42.666666 42.666666v96.213334l-142.122667-127.914667A42.666667 42.666667 0 0 0 512 682.666667h-42.666667a42.666667 42.666667 0 1 0 0 85.333333h26.282667l129.962667 116.949333C680.533333 934.4 768 895.402667 768 821.546667v-57.6c95.488-18.432 170.666667-97.536 170.666667-197.12v-237.653334C938.666667 215.082667 840.106667 128 725.333333 128H298.666667zM256 341.333333a42.666667 42.666667 0 0 1 42.666667-42.666666h426.666666a42.666667 42.666667 0 1 1 0 85.333333H298.666667a42.666667 42.666667 0 0 1-42.666667-42.666667z m42.666667 128a42.666667 42.666667 0 1 0 0 85.333334h256a42.666667 42.666667 0 1 0 0-85.333334H298.666667z"
              fill="#bfbfbf"/>
        </svg>
      </el-button>
      <el-button class="delete-btn" v-if="isOwnComment" type="text" @click="handleDelete">
        <svg x="1736063992041" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
             p-id="4261" width="20" height="20">
          <path
              d="M928.16 144H736V64a32 32 0 0 0-32-32H320a32 32 0 0 0-32 32v80H95.84a32 32 0 0 0 0 64H129.6l77.92 698.656A96 96 0 0 0 302.912 992h418.144a96.032 96.032 0 0 0 95.424-85.344L894.4 208h33.728a32 32 0 0 0 0.032-64zM352 96h320v48H352V96z m400.896 803.552a32 32 0 0 1-31.808 28.448H302.912a32 32 0 0 1-31.808-28.448L193.984 208h636.032l-77.12 691.552z"
              p-id="4262" fill="#bfbfbf"></path>
          <path
              d="M608 820.928a32 32 0 0 0 32-32V319.104a32 32 0 0 0-64 0v469.824a32 32 0 0 0 32 32zM432 820.928a32 32 0 0 0 32-32V319.104a32 32 0 0 0-64 0v469.824a32 32 0 0 0 32 32z"
              p-id="4263" fill="#bfbfbf"></path>
        </svg>
      </el-button>
    </div>
  </div>
</template>

<script>
export default {
  name: 'CommentActions',
  props: {
    id: {
      type: [String, Number],
      required: true
    },
    type: {
      type: String,
      required: true
    },
    isLiked: {
      type: Boolean,
      default: false
    },
    likeCount: {
      type: Number,
      default: 0
    },
    index: {
      type: Number,
      required: true
    },
    isOwnComment: {
      type: Boolean,
      default: false
    }
  },
  data() {
    return {
      dialogVisible: false
    }
  },
  methods: {
    handleLike() {
      this.$emit('like', this.id, this.type);
    },
    handleReply() {
      this.$emit('reply', this.index, this.type, this.id);
    },
    handleDelete() {
      this.dialogVisible = true;
    },
    confirmDelete() {
      this.$emit('delete', this.id, this.type);
      this.dialogVisible = false;
    }
  }
}
</script>

<style scoped>
.comment-actions {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  min-height: 60px;
}

.top-actions {
  display: flex;
  align-items: baseline;
}

.bottom-actions {
  display: flex;
  align-items: unset;
}

.like-btn {
  padding: 0;
  height: auto;
}

.reply-btn {
  padding: 0;
  height: auto;
  margin-left: 16px;
  background: transparent;
  border: none;
}

.delete-btn {
  padding: 0;
  height: auto;
  background: transparent;
  border: none;
  color: #bfbfbf;
}

.delete-btn:hover {
  color: #f56c6c;
}

.icon {
  vertical-align: middle;
}

.dialog-footer {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

.custom-dialog-center {
  position: fixed !important; /* 确保固定定位 */
  top: 50% !important; /* 垂直居中 */
  left: 50% !important; /* 水平居中 */
  transform: translate(-50%, -50%) !important; /* 调整偏移实现精确居中 */
  margin: 0 !important; /* 移除默认弹窗的 margin */
}
</style>